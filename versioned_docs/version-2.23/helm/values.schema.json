{"$defs":{"affinity":{"$ref":"#/definitions/io.k8s.api.core.v1.Affinity"},"duration":{"pattern":"^[+-]?(\\d+(\\.\\d+)?(h|m|s|ms|us|Âµs))+","type":"string"},"labelSelector":{"$ref":"#/definitions/io.k8s.apimachinery.pkg.apis.meta.v1.LabelSelector"},"localObjectReference":{"$ref":"#/definitions/io.k8s.api.core.v1.LocalObjectReference"},"logLevel":{"enum":["error","warning","info","debug","trace"],"type":"string"},"nodeSelector":{"additionalProperties":{"type":"string"},"type":"object"},"podSecurityContext":{"$ref":"#/definitions/io.k8s.api.core.v1.PodSecurityContext"},"probe":{"$ref":"#/definitions/io.k8s.api.core.v1.Probe"},"pullPolicy":{"enum":["Always","Never","IfNotPresent"],"type":"string"},"quantity":{"$ref":"#/definitions/io.k8s.apimachinery.pkg.api.resource.Quantity"},"resourceRequirements":{"$ref":"#/definitions/io.k8s.api.core.v1.ResourceRequirements"},"rfc1123Label":{"description":"RFC 1123 label name","pattern":"^[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?$","type":"string"},"securityContext":{"$ref":"#/definitions/io.k8s.api.core.v1.SecurityContext"},"subject":{"$ref":"#/definitions/io.k8s.api.rbac.v1.Subject"},"toleration":{"$ref":"#/definitions/io.k8s.api.core.v1.Toleration"}},"$id":"https://github.com/telepresenceio/telepresence-oss.schema.json","$schema":"https://json-schema.org/draft/2020-12/schema#","additionalProperties":false,"description":"Values Schema for the Telepresence OSS Helm Chart","properties":{"affinity":{"$ref":"#/$defs/affinity","description":"If specified, the pod's scheduling constraints"},"agent":{"additionalProperties":false,"description":"Telepresence traffic-agent configuration","properties":{"appProtocolStrategy":{"description":"The strategy to use when determining the application protocol to use for intercepts","enum":["http2Probe","portName","http","http2"],"type":"string"},"image":{"additionalProperties":false,"properties":{"name":{"description":"The name of the injected agent image","type":"string"},"pullPolicy":{"$ref":"#/$defs/pullPolicy","description":"Pull policy in the webhook for the traffic agent image"},"registry":{"description":"The registry for the injected agent image","type":"string"},"tag":{"description":"Overrides the image tag whose default is the chart appVersion","type":"string"}},"type":"object"},"initContainer":{"additionalProperties":false,"description":"Configuration for the init-container that runs before the traffic-agent","properties":{"enabled":{"description":"Enable/Disable the init-container","type":"boolean"}},"type":"object"},"initResources":{"$ref":"#/$defs/resourceRequirements","description":"Resource requirements for the init-container"},"initSecurityContext":{"$ref":"#/$defs/securityContext","description":"Security context for the init-container"},"logLevel":{"$ref":"#/$defs/logLevel","description":"Loglevel for the agent, if different from the traffic-manager"},"mountPolicies":{"additionalProperties":{"description":"The name or path prefix match of the volume that the policy applies to","enum":["Remote","RemoteReadOnly","Local","Ignore"],"type":"string"},"description":"List of volume mount policies. Defaults to {\"/tmp\" : \"Ignore\"}","type":"object"},"port":{"description":"Port number of the first port that the agent will use","type":"integer"},"resources":{"$ref":"#/$defs/resourceRequirements","description":"Resource requirements for the agent"},"securityContext":{"$ref":"#/$defs/securityContext","description":"Security context for the agent"}},"type":"object"},"agentInjector":{"additionalProperties":false,"description":"Properties for the agent injector service","properties":{"certificate":{"additionalProperties":false,"properties":{"accessMethod":{"description":"Method used by the agent injector to access the certificate (watch or mount)","enum":["watch","mount"],"type":"string"},"certmanager":{"additionalProperties":false,"properties":{"commonName":{"description":"The common name of the generated Certmanager certificate","type":"string"},"duration":{"$ref":"#/$defs/duration","description":"The certificate validity duration"},"issuerRef":{"additionalProperties":false,"properties":{"kind":{"description":"The Issuer kind to use to generate the self signed certificate (Issuer of ClusterIssuer)","enum":["Issuer","ClusterIssuer"],"type":"string"},"name":{"description":"The Issuer name to use to generate the self signed certificate","type":"string"}},"type":"object"}},"type":"object"},"method":{"description":"Method used when generating the certificate used for mutating webhook (helm, supplied, or certmanager)","enum":["helm","supplied","certmanager"],"type":"string"},"regenerate":{"description":"Whether the certificate used for the mutating webhook should be regenerated","type":"boolean"}},"type":"object"},"enabled":{"description":"Enable/Disable the agent-injector and its webhook","type":"boolean"},"injectPolicy":{"description":"Determines when an agent is injected, possible values are OnDemand and WhenEnabled","enum":["OnDemand","WhenEnabled"],"type":"string"},"name":{"description":"Name to use with objects associated with the agent-injector","type":"string"},"secret":{"properties":{"name":{"$ref":"#/$defs/rfc1123Label","description":"The name of the secret the agent-injector webhook uses for authorization with the kubernetes api will expose"}},"type":"object"},"service":{"additionalProperties":false,"properties":{"type":{"description":"Type of service for the agent-injector.","type":"string"}},"type":"object"},"webhook":{"additionalProperties":false,"properties":{"admissionReviewVersions":{"description":"List of supported admissionReviewVersions","items":{"type":"string"},"type":"array"},"failurePolicy":{"description":"Action to take on unexpected failure or timeout of webhook.","enum":["Fail","Ignore"],"type":"string"},"name":{"description":"The name of the agent-injector webhook","type":"string"},"port":{"description":"Port for the service that provides the admission webhook","type":"integer"},"reinvocationPolicy":{"description":"Specify if the webhook may be called again after the initial webhook call. Possible values are Never and IfNeeded","enum":["IfNeeded","Never"],"type":"string"},"servicePath":{"description":"Path to the service that provides the admission webhook","type":"string"},"sideEffects":{"description":"Any side effects the admission webhook makes outside of AdmissionReview","enum":["None","NoneOnDryRun","Some","Unknown"],"type":"string"},"timeoutSeconds":{"description":"Timeout of the admission webhook","type":"integer"}},"type":"object"}},"type":"object"},"apiPort":{"description":"The port used by the Traffic Manager gRPC API","type":"integer"},"client":{"properties":{"connectionTTL":{"$ref":"#/$defs/duration","description":"The time that the traffic-manager will retain a client connection without any sign of life from the workstation","type":"string"},"dns":{"properties":{"excludeSuffixes":{"description":"Suffixes for which the client DNS resolver will always fail (or fallback in case of the overriding resolver) Defaults to [\".com\", \".io\", \".net\", \".org\", \".ru\"]","items":{"type":"string"},"type":"array"},"includeSuffixes":{"description":"Suffixes for which the client DNS resolver will always attempt to do a lookup. Includes have higher priority than excludes","items":{"type":"string"},"type":"array"}},"type":"object"},"routing":{"properties":{"allowConflictingSubnets":{"description":"Allow the specified subnets to be routed even if they conflict with other routes on the local machine","items":{"type":"string"},"type":"array"},"alsoProxySubnets":{"description":"The virtual network interface of connected clients will also proxy these subnets","items":{"type":"string"},"type":"array"},"neverProxySubnets":{"description":"The virtual network interface of connected clients never proxy these subnets","items":{"type":"string"},"type":"array"}},"type":"object"}},"type":"object"},"clientRbac":{"additionalProperties":false,"properties":{"create":{"description":"Create RBAC resources for non-admin users with this release","type":"boolean"},"namespaces":{"description":"The namespaces to give users access to. Defaults to Traffic Manager's namespaces (unless dynamic)","items":{"$ref":"#/$defs/rfc1123Label"},"type":"array"},"ruleExtras":{"description":"If set, run the clientRbac-ruleExtras template to add additional RBAC rules.","type":"boolean"},"subjects":{"description":"The user accounts to tie the created roles to","items":{"$ref":"#/$defs/subject"},"type":"array"}},"type":"object"},"global":{"additionalProperties":true,"type":"object"},"grpc":{"additionalProperties":false,"properties":{"maxReceiveSize":{"$ref":"#/$defs/quantity","description":"maxReceiveSize is a quantity that configures the maximum message size that the traffic manager will service."}},"type":"object"},"hooks":{"additionalProperties":false,"properties":{"busybox":{"additionalProperties":false,"properties":{"image":{"description":"The name of the image to use for busybox","type":"string"},"imagePullSecrets":{"description":"The Secret storing any credentials needed to access the image in a private registry","items":{"$ref":"#/$defs/localObjectReference"},"type":"array"},"pullPolicy":{"$ref":"#/$defs/pullPolicy","description":"Pull policy in the webhook for the image"},"registry":{"description":"The registry to download the image from","type":"string"},"tag":{"description":"Override the version of busybox to be installed","type":"string"}},"type":"object"},"curl":{"additionalProperties":false,"properties":{"image":{"description":"The name of the image to use for curl","type":"string"},"imagePullSecrets":{"description":"The Secret storing any credentials needed to access the image in a private registry","items":{"$ref":"#/$defs/localObjectReference"},"type":"array"},"pullPolicy":{"$ref":"#/$defs/pullPolicy","description":"Pull policy in the webhook for the image"},"registry":{"description":"The registry to download the image from","type":"string"},"tag":{"description":"Override the version of curl to be installed","type":"string"}},"type":"object"},"podSecurityContext":{"$ref":"#/$defs/podSecurityContext","description":"The Kubernetes SecurityContext for the chart hooks Pod"},"resources":{"$ref":"#/$defs/resourceRequirements","description":"Define resource requests and limits for the chart hooks"},"securityContext":{"$ref":"#/$defs/securityContext","description":"The Kubernetes SecurityContext for the chart hooks Container"}},"type":"object"},"hostNetwork":{"description":"Sets the spec.template.spec.hostNetwork for the Traffic Manager. Set this to true when using Calico on AWS EKS to ensure that the mutating webhook can communicate with the traffic manager","type":"boolean"},"image":{"additionalProperties":false,"properties":{"imagePullSecrets":{"description":"The Secret storing any credentials needed to access the image in a private registry","items":{"$ref":"#/$defs/localObjectReference"},"type":"array"},"name":{"description":"The name of the image to use for the traffic-manager","type":"string"},"pullPolicy":{"$ref":"#/$defs/pullPolicy","description":"Pull policy in the webhook for the traffic-manager image"},"registry":{"description":"The registry to download the image from","type":"string"},"tag":{"description":"Overrides the image tag whose default is the chart appVersion","type":"string"}},"type":"object"},"intercept":{"additionalProperties":false,"properties":{"environment":{"properties":{"excluded":{"description":"Environment variables to exclude from the list sent to the client during engagement","items":{"type":"string"},"type":"array"}},"type":"object"}},"type":"object"},"isCI":{"description":"isCI can be set to force the traffic-manager namespace to be \"ambassador\"","type":"boolean"},"livenessProbe":{"$ref":"#/$defs/probe","description":"Define livenessProbe for the traffic-manager"},"logLevel":{"$ref":"#/$defs/logLevel","description":"Define the logging level of the Traffic Manager"},"managerRbac":{"additionalProperties":false,"properties":{"create":{"description":"Create RBAC resources for traffic-manager with this release","type":"boolean"},"namespaces":{"deprecated":true,"description":"Declares a fixed set of managed namespaces","items":{"$ref":"#/$defs/rfc1123Label"},"type":"array"}},"type":"object"},"maxNamespaceSpecificWatchers":{"description":"Threshold controlling when the traffic-manager switches from using watchers for each managed namespace to using cluster-wide watchers","maximum":50,"minimum":0,"type":"integer"},"nameOverride":{"description":"Override the default name prefix used when creating RBAC resources","type":"string"},"namespaceSelector":{"$ref":"#/$defs/labelSelector","description":"Declares the managed namespace using matchLabels and matchExpressions. Mutually exclusive to namespaces"},"namespaces":{"description":"Declares a fixed set of managed namespaces. Mutually exclusive to namespaceSelector","items":{"$ref":"#/$defs/rfc1123Label"},"type":"array"},"nodeSelector":{"$ref":"#/$defs/nodeSelector","description":"Define which Nodes you want to the Traffic Manager to be deployed to."},"podAnnotations":{"additionalProperties":{"type":"string"},"description":"Annotations for the Traffic Manager Pod","type":"object"},"podCIDRStrategy":{"description":"Define the strategy that the traffic-manager uses to discover what CIDRs the cluster uses for pods","enum":["auto","coverPodIPs","environment","nodePodCIDRs"],"type":"string"},"podCIDRs":{"description":"podCIDRs is the verbatim list of CIDRs used when the podCIDRStrategy is set to environment","items":{"type":"string"},"type":"array"},"podLabels":{"additionalProperties":{"type":"string"},"description":"Labels for the Traffic Manager Pod","type":"object"},"podSecurityContext":{"$ref":"#/$defs/podSecurityContext","description":"The Kubernetes SecurityContext for the traffic-manager Pod"},"priorityClassName":{"description":"Name of the existing pod priority class to be used","type":"string"},"prometheus":{"additionalProperties":false,"properties":{"port":{"description":"Set this port number to enable a prometheus metrics http server for the traffic manager","type":"integer"}},"type":"object"},"rbac":{"additionalProperties":false,"properties":{"only":{"description":"Only create the RBAC resources and omit the traffic-manger","type":"boolean"}},"type":"object"},"readinessProbe":{"$ref":"#/$defs/probe","description":"Define readinessProbe for the Traffic Manger."},"replicaCount":{"const":1,"description":"Number or replicas for the traffic-manager. The Traffic Manager only support running with one replica at the moment."},"resources":{"$ref":"#/$defs/resourceRequirements","description":"Define resource requests and limits for the Traffic Manger"},"schedulerName":{"description":"Specify a scheduler for Traffic Manager Pod and hooks Pod","type":"string"},"securityContext":{"$ref":"#/$defs/securityContext","description":"The Kubernetes SecurityContext for the traffic-manager container"},"service":{"additionalProperties":false,"properties":{"type":{"description":"The type of service for the traffic-manager","type":"string"}},"type":"object"},"telepresenceAPI":{"additionalProperties":false,"properties":{"port":{"description":"The port on agent's localhost where the Telepresence API server can be found","type":"integer"}},"type":"object"},"timeouts":{"additionalProperties":false,"properties":{"agentArrival":{"$ref":"#/$defs/duration","description":"The time that the traffic-manager will wait for the traffic-agent to arrive"}},"type":"object"},"tolerations":{"description":"Define tolerations for the Traffic Manager to ignore Node taints","items":{"$ref":"#/$defs/toleration"},"type":"array"},"workloads":{"additionalProperties":false,"properties":{"argoRollouts":{"additionalProperties":false,"properties":{"enabled":{"description":"Enable/Disable the argo-rollouts integration","type":"boolean"}},"type":"object"},"deployments":{"additionalProperties":false,"properties":{"enabled":{"description":"Enable/Disable the support for Deployments","type":"boolean"}},"type":"object"},"replicaSets":{"additionalProperties":false,"properties":{"enabled":{"description":"Enable/Disable the support for ReplicaSets","type":"boolean"}},"type":"object"},"statefulSets":{"additionalProperties":false,"properties":{"enabled":{"description":"Enable/Disable the support for StatefulSets","type":"boolean"}},"type":"object"}},"type":"object"}},"title":"Telepresence Values","type":"object"}